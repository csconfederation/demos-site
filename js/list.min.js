$(function(t){function i(t,i,e){var n=i.find("Key").text();this.name=n.substring(t.length),this.href=e+n,this.title=this.name.split("-").slice(0,-1).join("-").trim(),this.title.match(/^The\s/i)&&(this.title=this.title.replace(/^The\s/i,"")+", The"),this.date=new Date(i.find("LastModified").text()),this.size=parseInt(i.find("Size").text()),this.toRow=function(){return!this.name||o.indexOf(n)>-1?void 0:["<tr>",'<td><span class="ion-document-text"></span></td>','<td><a href="',this.href,'">',this.name,"</a></td>","<td>",this.date.toLocaleString(),"</td>","<td>",this.size.toBytes(),"</td>","</tr>"].join("")}}function e(t){var i=t.find("Prefix").text();this.name=i.split("/").slice(-2).join("/"),this.title=this.name.split("-").slice(0,-1).join("-").trim(),this.title.match(/^The\s/i)&&(this.title=this.title.replace(/^The\s/i,"")+", The"),this.href=location.pathname+"?path="+i,this.toRow=function(){return!this.name||a.indexOf(this.name)>-1?void 0:["<tr>",'<td><span class="ion-ios7-folder"></span></td>','<td><a href="',this.href,'">',this.name,"</a></td>","<td></td><td>-</td>","</tr>"].join("")}}function n(t){this.path=t.replace(/\/$/,"").split("/").slice(0,-1).concat("").join("/"),this.toRow=function(){return['<tr><td class="ion-arrow-return-left">',"</td><td colspan=3>",'<a href="?path=',this.path,'">../</a>',"</td></tr>"].join("")}}function r(r,s){var r=t(r),o=t(r.find("Prefix")[0]).text();this.files=t.map(r.find("Contents"),function(e){return new i(o,t(e),s)}),this.dirs=t.map(r.find("CommonPrefixes"),function(i){return new e(t(i))}),this.render=function(){var i=t("#items tbody");i.html("").parent().show(),o&&i.append(new n(o).toRow()),t.each(this.dirs,function(t,e){i.append(e.toRow())}),t.each(this.files,function(t,e){i.append(e.toRow())})}}Number.prototype.toBytes=function(){if(0===this)return"0 bytes";var t=parseInt(Math.floor(Math.log(this)/Math.log(1024))),i=Math.round(this/Math.pow(1024,t)*10)/10;return[i,["bytes","KB","MB","GB","TB"][t]].join(" ")},Array.prototype.sortBy=function(t,i){var e="asc"===i;return this.sort(function(i,n){return i[t]<n[t]?e?1:-1:i[t]>n[t]?e?-1:1:0})};var s,o=[".htpasswd","index.html","robots.txt","favicon.ico"],a=["fonts/","js/"];t(".sortable").click(function(i){var e=t(this),n=e.attr("data-dir"),r=e.attr("data-field");s.files=s.files.sortBy(r,n),s.dirs="title"===r?s.dirs.sortBy(r,n):s.dirs.sortBy("title","desc"),s.render(),t(".sortable").removeClass("active"),e.addClass("active"),e.attr("data-dir","asc"===n?"desc":"asc")});var h=function(t){var i=t+"?delimiter=/",e=/.*[?&]path=([^&]+)(&.*)?$/,n=location.search.match(e);if(n){var r=n[1].replace(/\/$/,"")+"/";i+="&prefix="+r}return i},d=function(i){var e=i.replace(/\/$/,"")+"/";t.get(h(e)).done(function(i){t("#loading").hide(),s=new r(i,e),t(".sortable.active").click()}).fail(function(t){alert("There was an error"),console.error(t)})},c=function(t,i){var e=CryptoJS.AES.decrypt(t,i);return e.toString(CryptoJS.enc.Utf8)};t("#login").submit(function(i){var e=t(this).find("input").val(),n=c(window.SECRET_BUCKET_URL,e);return t("#login").hide(),t("#loading").show(),d(n),!1}),window.SECRET_BUCKET_URL?(t("#loading").hide(),t("#login").show()):d(window.S3_BUCKET_URL)});
