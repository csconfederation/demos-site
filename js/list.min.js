$(function(t){function i(t,i){var e=i.find("Key").text();this.name=e.substring(t.length),this.href=window.S3_BUCKET_URL+e,this.title=this.name.split("-").slice(0,-1).join("-").trim(),this.title.match(/^The\s/i)&&(this.title=this.title.replace(/^The\s/i,"")+", The"),this.date=new Date(i.find("LastModified").text()),this.size=parseInt(i.find("Size").text()),this.toRow=function(){return!this.name||o.indexOf(e)>-1?void 0:["<tr>",'<td><span class="ion-document-text"></span></td>','<td><a href="',this.href,'">',this.name,"</a></td>","<td>",this.date.toLocaleString(),"</td>","<td>",this.size.toBytes(),"</td>","</tr>"].join("")}}function e(t){var i=t.find("Prefix").text();this.name=i.split("/").slice(-2).join("/"),this.title=this.name.split("-").slice(0,-1).join("-").trim(),this.title.match(/^The\s/i)&&(this.title=this.title.replace(/^The\s/i,"")+", The"),this.href=location.pathname+"?path="+i,this.toRow=function(){return!this.name||h.indexOf(this.name)>-1?void 0:["<tr>",'<td><span class="ion-ios7-folder"></span></td>','<td><a href="',this.href,'">',this.name,"</a></td>","<td></td><td>-</td>","</tr>"].join("")}}function n(t){this.path=t.replace(/\/$/,"").split("/").slice(0,-1).concat("").join("/"),this.toRow=function(){return['<tr><td class="ion-arrow-return-left">',"</td><td colspan=3>",'<a href="?path=',this.path,'">../</a>',"</td></tr>"].join("")}}function s(s){var s=t(s),r=t(s.find("Prefix")[0]).text();this.files=t.map(s.find("Contents"),function(e){return new i(r,t(e))}),this.dirs=t.map(s.find("CommonPrefixes"),function(i){return new e(t(i))}),this.render=function(){var i=t("#items tbody");i.html("").parent().show(),r&&i.append(new n(r).toRow()),t.each(this.dirs,function(t,e){i.append(e.toRow())}),t.each(this.files,function(t,e){i.append(e.toRow())})}}window.S3_BUCKET_URL=window.S3_BUCKET_URL.replace(/\/$/,"")+"/";var r=function(){var t=window.S3_BUCKET_URL+"?delimiter=/",i=/.*[?&]path=([^&]+)(&.*)?$/,e=location.search.match(i);if(e){var n=e[1].replace(/\/$/,"")+"/";t+="&prefix="+n}return t}();Number.prototype.toBytes=function(){if(0===this)return"0 bytes";var t=parseInt(Math.floor(Math.log(this)/Math.log(1024))),i=Math.round(this/Math.pow(1024,t)*10)/10;return[i,["bytes","KB","MB","GB","TB"][t]].join(" ")},Array.prototype.sortBy=function(t,i){var e="asc"===i;return this.sort(function(i,n){return i[t]<n[t]?e?1:-1:i[t]>n[t]?e?-1:1:0})};var a,o=["index.html","robots.txt","favicon.ico"],h=["fonts/","js/"];t(".sortable").click(function(){var i=t(this),e=i.attr("data-dir"),n=i.attr("data-field");a.files=a.files.sortBy(n,e),a.dirs="title"===n?a.dirs.sortBy(n,e):a.dirs.sortBy("title","desc"),a.render(),t(".sortable").removeClass("active"),i.addClass("active"),i.attr("data-dir","asc"===e?"desc":"asc")}),t.get(r).done(function(i){t("#loading").hide(),a=new s(i),t(".sortable.active").click()}).fail(function(t){alert("There was an error"),console.error(t)})});